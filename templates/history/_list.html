<h2>History</h2>
<div class="table-responsive">
    <table class="table table-sm">
        <thead>
            <tr>
                <th>Date</th>
                <th>Action</th>
                <th>Status</th>
                <th>Changes</th>
                <th>User</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
        {% for cr in history %}
            <tr>
            <td class="text-nowrap">{{ cr.date|date:'SHORT_DATETIME_FORMAT' }}</td>
            <td>{{ cr.request_type }}</td>
            <td>{{ cr.status }}</td>
            <td class="w-100">
            {% for field, value in cr.fields.items %}
                {{ field|title }}{% if cr.related %}: {{ value }}{% endif %}{% if not forloop.last %}, {% endif %}
            {% empty %}
                -
            {% endfor %}
            </td>
            <td class="text-nowrap">{{ cr.user.username }}</td>
            <td><a class="btn btn-outline-secondary btn-sm py-0" href="{{ cr.url }}">View</a></td>
            </tr>
        {% empty %}
            <tr><td class="font-italic text-center" colspan="8">None</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>